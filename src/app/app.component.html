<div class="min-h-screen bg-gray-100 dark:bg-gray-900 flex flex-col">
  <!-- Header -->
  <header class="bg-white dark:bg-gray-800 shadow-md sticky top-0 z-10">
    <div class="container mx-auto px-4">
      <!-- Desktop navbar -->
      <div class="flex justify-between items-center h-16">
        <!-- Logo -->
        <a routerLink="/" class="text-xl md:text-2xl font-bold flex items-center text-blue-600 dark:text-blue-400">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mr-2" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          AI Image Studio
        </a>

        <!-- Desktop Navigation -->
        <div class="hidden md:flex items-center">
          <nav class="flex space-x-1">
            <a routerLink="/"
              routerLinkActive="text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400"
              [routerLinkActiveOptions]="{exact: true}"
              class="px-3 py-4 text-gray-700 dark:text-gray-300 font-medium hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
              Home
            </a>
            <a routerLink="/generate"
              routerLinkActive="text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400"
              class="px-3 py-4 text-gray-700 dark:text-gray-300 font-medium hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
              Generate
            </a>
            <a routerLink="/modify"
              routerLinkActive="text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400"
              class="px-3 py-4 text-gray-700 dark:text-gray-300 font-medium hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
              Modify
            </a>
            <a routerLink="/gallery"
              routerLinkActive="text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400"
              class="px-3 py-4 text-gray-700 dark:text-gray-300 font-medium hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
              Gallery
            </a>
          </nav>
        </div>

        <!-- Right actions group -->
        <div class="flex items-center space-x-3">
          <!-- Visitor count badge -->
          @if (visitorCount() > 0) {
          <div
            class="hidden md:flex items-center text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-3 py-1 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
            <span>{{ visitorCount() }}</span>
          </div>
          }

          <!-- Loading indicator -->
          @if (isTrackingLoading()) {
          <div
            class="animate-spin h-4 w-4 border-2 border-blue-600 dark:border-blue-400 border-t-transparent rounded-full">
          </div>
          }

          <!-- Theme toggle button -->
          <button (click)="toggleTheme()"
            class="p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
            aria-label="Toggle theme">
            @if (darkMode()) {
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
            </svg>
            } @else {
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
            </svg>
            }
          </button>

          <!-- Mobile menu button -->
          <button (click)="toggleMobileMenu()"
            class="md:hidden p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            @if (mobileMenuOpen()) {
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
            } @else {
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
            }
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile menu -->
    @if (mobileMenuOpen()) {
    <div class="md:hidden bg-gray-50 dark:bg-gray-800 shadow-inner">
      <nav class="py-3 px-4 space-y-1">
        <a routerLink="/" routerLinkActive="text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20"
          [routerLinkActiveOptions]="{exact: true}"
          class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
          (click)="toggleMobileMenu()">
          Home
        </a>
        <a routerLink="/generate" routerLinkActive="text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20"
          class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
          (click)="toggleMobileMenu()">
          Generate
        </a>
        <a routerLink="/modify" routerLinkActive="text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20"
          class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
          (click)="toggleMobileMenu()">
          Modify
        </a>
        <a routerLink="/gallery" routerLinkActive="text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20"
          class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
          (click)="toggleMobileMenu()">
          Gallery
        </a>

        <!-- Visitor count for mobile -->
        @if (visitorCount() > 0) {
        <div class="mt-2 px-3 py-2 text-xs flex items-center text-gray-600 dark:text-gray-300">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
          <span>{{ visitorCount() }} visitors</span>
        </div>
        }
      </nav>
    </div>
    }
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-6 flex-grow">
    <!-- This is where router-outlet will render the active route component -->
    <router-outlet></router-outlet>
  </main>

  <!-- Footer -->
  <footer class="bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 shadow-inner text-center py-4 mt-auto">
    <div class="container mx-auto">
      <p class="text-sm">Â© {{ currentYear() }} AI Image Studio. All rights reserved.</p>
      @if (trackingError()) {
      <p class="text-xs text-red-500 mt-1">{{ trackingError() }}</p>
      }
    </div>
  </footer>
</div>